---
title: "Building Python from Source"
summary: "This document will walk through building Python from source and (for my own
personal utility) setting up a comprehensive global Python environment."
author: Daniel Molitor
date: "2022-05-04"
output: md_document
categories: ["Python", "Linux"]
image:
  caption: ""
  focal_point: ""
  placement: 2
  preview_only: false
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>This document will walk through building Python from source and (for my own
personal utility) setting up a comprehensive global Python environment. It draws
largely <a href="https://tttapa.github.io/Pages/Ubuntu/Software-Installation/Python.html">from this document</a>. <strong>Note</strong>: my current OS is Ubuntu, 22.04, LTS Jammy Jellyfish.</p>
<div id="build-python" class="section level2">
<h2>Build Python</h2>
<div id="install-dependencies" class="section level3">
<h3>Install Dependencies</h3>
<pre><code>sudo apt -y update
sudo apt -y install gcc \
    g++ \
    make \
    wget \
    zlib1g-dev \
    libbz2-dev \
    libssl-dev \
    uuid-dev \
    libffi-dev \
    libreadline-dev \
    libsqlite3-dev \
    tk-dev \
    libbz2-dev \
    libncurses5-dev \
    libreadline6-dev \
    libgdbm-dev \
    liblzma-dev \
    libgdbm-compat-dev</code></pre>
</div>
<div id="download-and-extract-source" class="section level3">
<h3>Download and Extract Source</h3>
<p>The current latest version of python is <code>3.10.4</code>.</p>
<pre class="shell"><code>cd /tmp
sudo wget &quot;https://www.python.org/ftp/python/3.10.4/Python-3.10.4.tgz&quot;
sudo tar xf Python-3.10.4.tgz</code></pre>
</div>
<div id="configure-build-settings" class="section level3">
<h3>Configure Build Settings</h3>
<p>The installation location is <code>~/.local</code>.</p>
<pre><code>cd Python-3.10.4
./configure --prefix=&quot;$HOME/.local&quot; \
    --enable-ipv6 \
    --enable-shared \
    --with-lto --enable-optimizations \
    &#39;LDFLAGS=-Wl,-rpath,\$$ORIGIN/../lib&#39;</code></pre>
</div>
<div id="build-python-1" class="section level3">
<h3>Build Python</h3>
<p>This will build in parallel with as many cores as the system has available.</p>
<pre><code>make -j$(nproc)</code></pre>
</div>
<div id="install-python" class="section level3">
<h3>Install Python</h3>
<pre><code>make install</code></pre>
</div>
</div>
<div id="create-environment" class="section level2">
<h2>Create Environment</h2>
<div id="create-global-python-virtual-env" class="section level3">
<h3>Create Global Python Virtual Env</h3>
<p>I will create a default Python virtual environment at <code>~/.venv/default</code>.</p>
<pre><code>mkdir ~/.venv
cd ~/.venv
~/.local/bin/python3 -m venv default
source default/bin/activate</code></pre>
<p>Assuming you have a url to a text file containing all Python modules you want to
install (which I do), download that package list as follows:</p>
<pre><code>python -c &quot;import urllib.request; import os; packages = urllib.request.urlopen(&#39;url-to-package-list.txt&#39;).read().decode(&#39;utf-8&#39;); filename = os.path.expanduser(&#39;~&#39;) + &#39;/packages.txt&#39;; file_ = open(filename, &#39;w&#39;); file_.write(packages); file_.close()&quot;</code></pre>
<p>Now, pip install all the specified modules.</p>
<pre><code>pip install -r ../packages.txt --upgrade --force-reinstall --no-cache-dir
deactivate</code></pre>
<p>And voila, there you have it!</p>
</div>
</div>
